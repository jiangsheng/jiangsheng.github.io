<!doctype html><html><head><meta charset="UTF-8"<title>Lab5 Draft1</head><body><div id="msgcns!1BE894DEAF296E0A!188" class="bvMsg"><font size="2"> <p>;=====================================================================</p> <p>; lab5.asm - build a program that displays the Fibonacci numbers for a user defined input upper bound</p> <p>; Author: Sheng_Jiang</p> <p>; Course: COSC 2425</p> <p>; Date: 6/15/05</p> <p>;=====================================================================</p> <p>.386</p> <p>.MODEL flat, stdcall</p> <p>option casemap:none</p> <p></p> <p>include windows.inc ; always first</p> <p>include macros.asm ; MASM support macros</p> <p>; -----------------------------------------------------------------</p> <p>; include files that have MASM format prototypes for function calls</p> <p>; -----------------------------------------------------------------</p> <p>include masm32.inc</p> <p>include gdi32.inc</p> <p>include user32.inc</p> <p>include kernel32.inc</p> <p>; ------------------------------------------------</p> <p>; Library files that have definitions for function</p> <p>; exports and tested reliable prebuilt code.</p> <p>; ------------------------------------------------</p> <p>includelib masm32.lib</p> <p>includelib gdi32.lib</p> <p>includelib user32.lib</p> <p>includelib kernel32.lib</p> <p></p> <p>;costants</p> <p>CR EQU 0Dh</p> <p>LF EQU 0Ah</p> <p>DOCOMMAND_CONTINUE equ 1</p> <p>DOCOMMAND_END equ 0</p> <p></p> <p>.Data</p> <p>menuSelection DWORD 0</p> <p>DoCommandResult DWORD 0</p> <p></p> <p>.Code</p> <p>ShowMenu Proc</p> <p>print chr$(&quot;Menu&quot;,CR,LF,&quot;[I,N,F,X]&quot;)</p> <p>ret</p> <p>ShowMenu EndP</p> <p>;</p> <p>;usage:</p> <p>;push someThingToAllocateTheReturnValue</p> <p>;push command</p> <p>;call DoCommand</p> <p>;pop command</p> <p>;pop someThingToAllocateTheReturnValue</p> <p>;the return value can be one of the following:</p> <p>; DOCOMMAND_CONTINUE equ 1</p> <p>; DOCOMMAND_END equ 0</p> <p>DoCommand PROC</p> <p>push ebp</p> <p>mov ebp, esp</p> <p>push eax</p> <p>push ebx</p> <p>mov bl, BYTE PTR [ebp+8]</p> <p>cmp bl, 'x'</p> <p>je DoCommandEnd</p> <p>cmp bl, 'X'</p> <p>je DoCommandEnd</p> <p>mov eax, DOCOMMAND_CONTINUE</p> <p>jmp DoCommandCleanup</p> <p>DoCommandEnd:</p> <p>mov eax, DOCOMMAND_END</p> <p>DoCommandCleanup:</p> <p>mov [ebp+12],eax</p> <p>pop ebx</p> <p>pop eax</p> <p>mov esp,ebp</p> <p>pop ebp</p> <p>ret</p> <p>DoCommand ENDP</p> <p> </p> <p>main PROC</p> <p>int 3</p> <p>cls</p> <p>ShowMenuLoop: </p> <p>call ShowMenu</p> <p>mov menuSelection, input()</p> <p></p> <p>push DoCommandResult</p> <p>mov eax,menuSelection</p> <p>push [eax]</p> <p>call DoCommand</p> <p>pop menuSelection</p> <p>pop DoCommandResult</p> <p>cmp DoCommandResult,DOCOMMAND_CONTINUE</p> <p>je ShowMenuLoop</p> <p>exit</p> <p>main ENDP</p> <p>END main</p><font size="2"> <p>#=====================================================================</p> <p># lab5 - build a program that displays the Fibonacci numbers for a user defined input upper bound</p> <p># Author: Sheng_Jiang</p> <p># Course: COSC 2425</p> <p># Date: 6/15/05</p> <p>#=====================================================================</p> <p>PROJECT = Lab5</p> <p>NAME = Sheng_Jiang</p> <p>Date = 6/15/05</p> <p>ROOTDRIVE = C</p> <p>VERSION = V1</p> <p>SRCS = </p> <p>$(PROJECT).asm</p> <p>makefile </p> <p>MASM32 = $(ROOTDRIVE):/masm32</p> <p>ML = $(MASM32)/bin/ml</p> <p>LINK = $(MASM32)/bin/link</p> <p>Zip = H:/mydoc/Tools/Bin/zip</p> <p>DEBUG = c:/masm32/debug/windbg</p> <p> </p> <p>MLFLAGS = /I. /I $(MASM32)include /I $(MASM32)macros /Zi /Zd /Zf /c /Fl /coff /Cp</p> <p>LINKFLAGS = /subsystem:console /libpath:$(MASM32)lib /debug </p> <p>DEBUGFLAGS = -QY -g -G -WF $(PROJECT).WEW</p> <p>all: $(PROJECT).exe</p> <p>$(PROJECT).obj: $(PROJECT).asm</p> <p>$(ML) $(MLFLAGS) $(PROJECT).asm</p> <p>$(PROJECT).exe: $(PROJECT).obj</p> <p>$(LINK) $(LINKFLAGS) $(PROJECT).obj</p> <p>clean:</p> <p>del $(PROJECT).exe *.obj *.lst *.map *.pdb *.ilk</p> <p>zip: clean</p> <p>del $(NAME)_$(PROJECT)_$(VERSION).zip</p> <p>$(Zip) $(NAME)_$(PROJECT)_$(VERSION).zip $(SRCS)</p> <p>debug: $(PROJECT).exe</p> <p>$(DEBUG) $(DEBUGFLAGS) $(PROJECT).exe</p> <p> </p></font></font></div></body></html>