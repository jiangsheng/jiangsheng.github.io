<!doctype html><html><head><meta charset="UTF-8"<title>Make the webbrowser control styled the same way as the hosting application</head><body>User wtx_sonery <a href="http://topic.csdn.net/u/20091026/14/05db4eed-c766-4480-80ce-b030488bcae1.html">wants to know whether it is possible to style the webbrowser control with the rest of the application.</a> The answer is yes, you can implement IDocHostUIHandler’s GetHostInfo method and return DOCHOSTUIFLAG_THEME in the host flags.

IDocHostUIHandler is already implemented in MFC and <a class="zem_slink" title="Active Template Library" rel="wikipedia" href="http://en.wikipedia.org/wiki/Active_Template_Library">ATL</a>. For MFC there are CHtmlControlSite and CBrowserControlSite but you should be overriding the GetHostInfo function in CHTMLView and CDHTMLDialog. In ATL the template definition is in Atliface.h but you need to <a href="http://support.microsoft.com/kb/274202">derive from IDocHostUIHandlerDispatch by yourself.</a>

Implementing IDocHostUIHandler Windows Forms gets a little tricky. Windows Forms already implemented it on its WebBrowserSite class but you can’t extend it. Following the .Net <a href="http://msdn.microsoft.com/en-us/library/ms182161(v=VS.100).aspx">Framework Class Library Security Guideline</a> the Windows Forms version of the IDocHostUIHandler interface is internal to the class library. If you derive from WebBrowserSite and implement your own version of IDocHostUIHandler, you still get Windows Forms’s implementation of IDocHostUIHandler when you do <a class="zem_slink" title="IUnknown" rel="wikipedia" href="http://en.wikipedia.org/wiki/IUnknown">QueryInterface</a> on the browser site. That means you need to <a href="http://code.google.com/p/csexwb2/">get ride of the Windows Forms wrapper of the webbrowser control and provide your own hosting implementation.</a>

WPF/Silverlight users, you are out of luck. The stock version of the webbrowser control does not even provide a way to customize the host site. The best thing you can do is to see if Windows Forms interop is available to the platform and if so, embed a csexwb <a class="zem_slink" title="Windows Forms" rel="wikipedia" href="http://en.wikipedia.org/wiki/Windows_Forms">Windows Forms control</a>. There are some <a href="http://code.google.com/p/csexwb2/issues/detail?id=59">unsolved problems in the csexwb discussion area</a>, however.

There are <a href="http://msdn.microsoft.com/en-us/library/aa753277(VS.85).aspx">other switches</a> you can tweak the browser control’s behavior. However there is only one bit available in the enum for future flags. Maybe that’s why IE introduces <a href="http://msdn.microsoft.com/en-us/library/ms537184(VS.85).aspx">feature control</a> in IE6 for <a class="zem_slink" title="Windows XP" rel="homepage" href="http://www.microsoft.com/windows/windows-xp/default.aspx">Windows XP SP2</a> where <a href="http://msdn.microsoft.com/en-us/library/ms537169(v=VS.85).aspx">features are based on enum</a> – you get a 4GB range for new features!</body></html>