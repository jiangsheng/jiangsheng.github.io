<!doctype html><html><head><meta charset="UTF-8"<title>Getting local FTP home directory from IIS programmatically</head><body>User xiaoc1026 <a href="http://topic.csdn.net/u/20091118/09/2f26b4bb-e534-4252-a00d-d4222258baf8.html">wants to know</a> how to access <a class="zem_slink" title="Internet Information Services" rel="homepage" href="http://www.microsoft.com/iis">IIS</a> to get the <a class="zem_slink" title="Home directory" rel="wikipedia" href="http://en.wikipedia.org/wiki/Home_directory">home directory</a> of the <a class="zem_slink" title="File Transfer Protocol" rel="wikipedia" href="http://en.wikipedia.org/wiki/File_Transfer_Protocol">FTP</a> web site in <a class="zem_slink" title="Visual C++" rel="homepage" href="http://msdn2.microsoft.com/en-us/visualc/default.aspx">Visual C</a>++.

Before IIS6 you need to access the <a class="zem_slink" title="Metadata" rel="wikipedia" href="http://en.wikipedia.org/wiki/Metadata">metadata</a> in IIS configuration via <a href="http://msdn.microsoft.com/en-us/library/ms525079(VS.90).aspx">IMSAdminBase::GetData</a>. The hard part to find the path of the IIS setting. Before IIS 6, the metadata isnâ€™t saved in <a class="zem_slink" title="XML" rel="wikipedia" href="http://en.wikipedia.org/wiki/XML">XML</a>. However you can <a href="http://blogs.msdn.com/b/david.wang/archive/2005/07/08/howto-search-and-replace-any-iis-metabase-property-value-automatically.aspx">search the path of a property though the admin script</a>. You can find the <a href="http://msdn.microsoft.com/en-us/library/ms524600(v=VS.90).aspx">path property</a> from the IIS metadata propertiy reference documentation.

The IIS WMI provider, introduced in IIS6, makes the query a lot easier. Now you can query for <a href="http://msdn.microsoft.com/en-us/library/ms524913(VS.90).aspx">IIsFtpVirtualDirSetting.Path</a> directly, though querying metadata should still work.</body></html>