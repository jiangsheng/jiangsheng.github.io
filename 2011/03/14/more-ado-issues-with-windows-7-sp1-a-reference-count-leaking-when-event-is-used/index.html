<!doctype html><html><head><meta charset="UTF-8"<title>More ADO issues with KB983246/Windows 7 SP1: a reference count leaking when event is used</head><body><div class="zemanta-img">

[caption id="" align="alignright" width="300" caption="Image via Wikipedia"]<a href="http://en.wikipedia.org/wiki/File:Windows_Update.png"><img title="Windows Update" src="http://upload.wikimedia.org/wikipedia/en/thumb/b/b0/Windows_Update.png/300px-Windows_Update.png" alt="Windows Update" width="300" height="224" /></a>[/caption]

</div>
Update: Microsoft <a href="http://social.msdn.microsoft.com/Forums/en/windowsgeneraldevelopmentissues/thread/280de88a-77dd-455e-9797-b28928206e38">fixed the issue in Windows 8</a>.

User <a href="http://social.msdn.microsoft.com/forums/en-US/user/threads?userid=7bbf7b11-2c59-4de0-a0ee-50f23c738764">Angus Robertson</a> is <a href="http://social.msdn.microsoft.com/Forums/en/sqldataaccess/thread/68e23681-f6b5-4ed5-b963-e63e34eeac2f">reporting </a>that in an application that references <a class="zem_slink" title="ActiveX Data Objects" href="http://en.wikipedia.org/wiki/ActiveX_Data_Objects" rel="wikipedia">ADO</a> 2.1 type library and getting records using the adAsyncExecute method, each execute call  leaks three handles and about 20K of memory. A fix is promised in a future version of windows but since <a class="zem_slink" title="Microsoft Data Access Components" href="http://en.wikipedia.org/wiki/Microsoft_Data_Access_Components" rel="wikipedia">MDAC</a> is an in-band <a class="zem_slink" title="Operating system" href="http://en.wikipedia.org/wiki/Operating_system" rel="wikipedia">OS</a> component, an widely-available update would be in a <a class="zem_slink" title="Service pack" href="http://en.wikipedia.org/wiki/Service_pack" rel="wikipedia">service pack</a> just like how <a href="http://jiangshengvc.wordpress.com/2011/02/24/breaking-change-in-ado-update-kb983246-included-in-windows-7-service-pack-1/">kb983246 was delivered</a>. Concerned ADO users should contact <a class="zem_slink" title="Microsoft" href="http://en.wikipedia.org/wiki/Microsoft" rel="wikipedia">Microsoft</a> <a class="zem_slink" title="Technical support" href="http://en.wikipedia.org/wiki/Technical_support" rel="wikipedia">Customer Support</a> service and request a hotfix, once that is available.

By the way, if you are still in <a class="zem_slink" title="Windows XP" href="http://en.wikipedia.org/wiki/Windows_XP" rel="wikipedia">XP</a> or 2003, there is a <a href="http://support.microsoft.com/kb/955843">deadlock issue</a> when using the same adAsyncExecute option. This issue is fixed on <a class="zem_slink" title="Windows Vista" href="http://en.wikipedia.org/wiki/Windows_Vista" rel="wikipedia">Vista</a>.</body></html>