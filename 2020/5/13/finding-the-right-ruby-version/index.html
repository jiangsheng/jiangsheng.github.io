<!doctype html><html><head><meta charset="UTF-8"<title>Finding the right ruby version</head><body><p>I am installing eHMP on Centos 7. Centos 7 has ruby 2.0 out of box, thus the install </p><p>chef-client -o workstation --config ~/Projects/vistacore/.chef/knife.rb</p><p>fails with </p><p>rb-notify version 0.10.0 needs Ruby 2.2.2 or newer</p><p>Following the instructions at <a href="https://noobient.com/2019/02/12/installing-rvm-and-ruby-on-centos-7/">https://noobient.com/2019/02/12/installing-rvm-and-ruby-on-centos-7/</a> I got ruby 2.7 installed. However </p><p>sudo chef-client -o workstation --config ~/Projects/vistacore/.chef/knife.rb</p><p>fails with the same error.</p><p>run </p><p>ruby –version </p><p>shows that rvm has no effect on sudo. I am still running the script against Ruby 2.0</p><p>Supposedly I can sudo and install rvm there, but rvm complained and suggested me to use rvmsudo instead. Then I tried it, rvmsudo doesn’t carry over my environment, even $HOME, thus the script still fails.</p><p>After searching for awhile I found a walkaround </p><p>rvmsudo bash -c "HOME=$HOME; exec bash" chef-client -o workstation --config ~/Projects/vistacore/.chef/knife.rb</p><p>This gets the home directory passed to the script, now the script is complaining </p><p>STDERR: ERROR:&nbsp; While executing gem ... (OptionParser::InvalidOption) invalid option: --no-rdoc</p><p>The script was pretty old, I know. I have no time to fix the script, so I need to downgrade the ruby version. After testing for each version I settled for 2.3. </p><p>rvm install 2.3</p><p>rvm use 2.3 –default</p><p>sudo gem update --system 2.3</p><p>Now the script runs successfully. </p></body></html>