.. meta::
   :description: 问：请问如何在一个全局函数中，获得视图类，文档类得指针啊? 问：如何在一个对话框中，获得视图类，文档类得指针啊?

.. post:: 10, Nov, 2005
   :category: Microsoft Foundation Classes, Visual C++
   :author: me
   :nocomments:

FAQ:如何在……中获得……的指针(MFC)
=====================================

问：请问如何在一个全局函数中，获得视图类，文档类得指针啊?
问：如何在一个对话框中，获得视图类，文档类得指针啊?

答：虽然你可以使用AfxGetMainWnd或者AfxGetApp之类的函数来访问全局变量，但是不建议这么做。你应该尽量少使用全局函数和变量以增加代码的可移植性。你可以在对象中声明变量来保存和传递需要使用的对象和指针，调用函数或者创建对象时传递指针。

举例来说，如果视图的成员函数需要创建一个对话框，而对话框需要访问文档，那么可以在对话框类中声明一个文档指针，视图的成员函数创建对话框之后把对话框中的文档指针变量的值设置为和视图关联的文档指针。

再一个例子：对于在一个对话框按钮的处理函数中创建的线程，其线程函数中需要控制对话框。因为不能跨线程访问对话框对象，而且线程函数是全局函数。所以要把对话框中线程需要访问的数据封装成一个结构，然后将它和对话框句柄打包成另外一个结构，将其地址作为参数传递给线程函数。线程函数在启动时应该复制数据和对话框句柄，然后使用线程安全的Windows API或者再创建一个MFC对话框对象关联对话框句柄到来控制对话框。
